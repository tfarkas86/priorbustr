# find alpha given beta and mode
get_alpha <- function(beta, mode) mode * beta + 1
# get parameter value for given percentile
get_percentile <- function(beta, mode, pct, ndraw=10000) {
alpha <- get_alpha(beta, mode)
gamma_draws <- rgamma(ndraw, rate=beta, shape=alpha)
percentile <- quantile(gamma_draws, pct)
return(percentile)
}
# get absolute value of difference from target value
diff_pct <- function(beta, mode, pct, target, ndraw=10000) {
abs(get_percentile(beta, mode, pct, ndraw) - target)
}
gammabustr <- function(mode, pct, target, ndraw=10000,
beta_upper=100, plot=FALSE) {
beta_hat <- optim(par=1, fn=diff_pct, method="Brent", mode=mode,
pct=pct, target=target, ndraw=ndraw,
lower=0, upper=beta_upper)$par
parms <- c(alpha=get_alpha(beta=beta_hat, mode=mode), beta=beta_hat)
if(plot) {
sims <- tibble(sims=rgamma(ndraw, parms["alpha"], parms["beta"]))
p <- ggplot(data=sims, aes(x=sims))
print(p + geom_density() +
xlab("theta"))
}
return(parms)
}
library(tidyverse)
# find alpha given beta and mode
get_alpha <- function(beta, mode) mode * beta + 1
# get parameter value for given percentile
get_percentile <- function(beta, mode, pct, ndraw=10000) {
alpha <- get_alpha(beta, mode)
gamma_draws <- rgamma(ndraw, rate=beta, shape=alpha)
percentile <- quantile(gamma_draws, pct)
return(percentile)
}
# get absolute value of difference from target value
diff_pct <- function(beta, mode, pct, target, ndraw=10000) {
abs(get_percentile(beta, mode, pct, ndraw) - target)
}
gammabustr <- function(mode, pct, target, ndraw=10000,
beta_upper=100, plot=FALSE) {
beta_hat <- optim(par=1, fn=diff_pct, method="Brent", mode=mode,
pct=pct, target=target, ndraw=ndraw,
lower=0, upper=beta_upper)$par
parms <- c(alpha=get_alpha(beta=beta_hat, mode=mode), beta=beta_hat)
if(plot) {
sims <- tibble(sims=rgamma(ndraw, parms["alpha"], parms["beta"]))
p <- ggplot(data=sims, aes(x=sims))
print(p + geom_density() +
xlab("theta"))
}
return(parms)
}
gammabustr(.5, 0.95, 2)
load_all()
library(devtools)
load_all()
?gammabustr
rm diff_pct
rm(list=ls())
load_all
load_all()
gammabustr(0.5, 0.95, 2)
document()
?document
gammabustr(0.5, 0.95, 2, plot=TRUE)
?ggplot
load_all()
library(devtools)
load_all()
gammabustr(.5, .95, 2)
gammabustr(.5, .95, 2, plot=TRUE)
document()
load_all()
gammabustr(.5, .95, 2, plot=TRUE)
library(devtools)
load_all()
library(priorbustr)
library(priorbuster)
install()
library(devtools)
install()
library(priorbuster)
load_all()
install()
library(priorbustr)
install()
library(devtools)
install()
library(priorbustr)
gammabustr(.5, .95, 2, plot=TRUE)
library(devtools)
load_all()
install()
library(priorbustr)
gammabustr(.5, .95, 2, plot=TRUE)
load_all()
library(devtools)
use_package("dplyr")
use_package("ggplot2")
install()
library(devtools)
library(install)
install()
library(priorbustr)
gammabustr(.5, 0.95, 2, plot=TRUE)
library(devtools)
install()
